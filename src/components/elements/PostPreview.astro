---
import { calcTagCountByTagList, formatPostDate, getMonthName } from '$/utils'
import dayjs from 'dayjs'
import TagList from '$/components/elements/TagList.astro'
import type { Frontmatter } from '$/types'
import PostIcon from '$/components/elements/postIcon.astro'

dayjs().format()

interface Props {
  post: Frontmatter
  asCard?: boolean
}
const { post, asCard = false } = Astro.props

let postTitlePrefix = ''
switch (post.media) {
  case 'note':
    postTitlePrefix = '（note記事）'
    break
  case 'qiita':
    postTitlePrefix = '（Qiita記事）'
    break
  case 'zenn':
    postTitlePrefix = '（Zenn記事）'
    break
}
---

<li class="post-preview">
  <div class="post-preview__externalUrl"></div>
  <h4 class="post-preview__title" transition:name={`title:${post.link}`}>
    <a
      href={post.media === 'owned' ? `/blog/${post.link}` : post.link}
      title={post.title}
      target={post.media === 'owned' ? '' : '_blank'}
    >
      <span>{postTitlePrefix}</span>
      {post.title}
    </a>
  </h4>
  <div
    class:list={[
      'text-right mt-3',
      post.tagList && 'flex justify-between items-center',
    ]}
    transition:name={`date:${post.link}`}
  >
    {
      post.tagList && (
        <TagList
          items={calcTagCountByTagList(post.tagList)}
          postSlug={post.link}
        />
      )
    }
    <span class="post-preview__date">{formatPostDate(post.pubDate)}</span>
  </div>
</li>
<style>
  .post-preview {
    @apply rounded-lg bg-theme-wave-light dark:bg-theme-wave-dark  p-4 flex flex-col justify-between;
  }
  .post-preview__title {
    @apply mt-3 md:text-lg font-bold hover:underline text-base;
  }

  .post-preview__date {
    @apply text-xs text-right self-end;
  }
</style>
